version: '2'
 

 
services:
    prometheus:
        image: prom/prometheus
        container_name: prometheus
        hostname: prometheus
        restart: always
        volumes:
            - ./prometheus.yml:/etc/prometheus/prometheus.yml
        ports:
            - "9090:9090"
        networks:
            - docker_hatka
    
    node-exporter:
        image: quay.io/prometheus/node-exporter
        container_name: node-exporter
        hostname: node-exporter
        restart: always
        ports:
            - "9100:9100"
        networks:
            - docker_hatka
    
    grafana:
        image: grafana/grafana:9.0.1-ubuntu
        container_name: grafana
        hostname: grafana
        restart: always
        volumes:
            - ./grafana_data:/var/lib/grafana
        ports:
            - "3300:3000"
        networks:
            - docker_hatka
            
    cadvisor:
        image: gcr.io/cadvisor/cadvisor:v0.44.0
        container_name: cadvisor
        #privileged: true
        #devices:
        #    - /dev/kmsg:/dev/kmsg
        volumes:
            - /:/rootfs:ro
            - /var/run:/var/run:ro
            - /sys:/sys:ro
            - /var/lib/docker:/var/lib/docker:ro
            - /mnt/my-docker/version-pack-data/community/docker:/rootfs/var/lib/docker:ro
      #- /cgroup:/cgroup:ro #doesn't work on MacOS only for Linux
        restart: unless-stopped
        ports:
            - 8181:8080
        networks:
            - docker_hatka


networks:  
    docker_hatka:
        external: true